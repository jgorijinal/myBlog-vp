import{_ as e,r as o,o as c,c as l,a as n,e as p,F as u,d as t,b as s}from"./app.fcb85f29.js";var r="/myBlog-vp/assets/exl1.456aaeec.png",i="/myBlog-vp/assets/excel22.7c7d5a39.png";const k={},b=t('<h1 id="excel-\u3001zip-\u4E0E\u524D\u7AEF\u7ED3\u5408\u89E3\u51B3\u65B9\u6848-\u7528\u6237\u7BA1\u7406\u9875\u9762\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#excel-\u3001zip-\u4E0E\u524D\u7AEF\u7ED3\u5408\u89E3\u51B3\u65B9\u6848-\u7528\u6237\u7BA1\u7406\u9875\u9762\u5B9E\u73B0" aria-hidden="true">#</a> excel \u3001zip \u4E0E\u524D\u7AEF\u7ED3\u5408\u89E3\u51B3\u65B9\u6848 - \u7528\u6237\u7BA1\u7406\u9875\u9762\u5B9E\u73B0</h1><p>\u6574\u4E2A\u7528\u6237\u76F8\u5173\u7684\u6A21\u5757\u5206\u4E3A\u4E09\u90E8\u5206\uFF1A</p><ol><li>\u5458\u5DE5\u7BA1\u7406</li><li>\u89D2\u8272\u5217\u8868</li><li>\u6743\u9650\u5217\u8868</li></ol><p>\u73B0\u5728\u8981\u6765\u5904\u7406\u7684\u5C31\u662F <strong>\u5458\u5DE5\u7BA1\u7406</strong> \u6A21\u5757\u7684\u5185\u5BB9\uFF0C\u6574\u4E2A <strong>\u5458\u5DE5\u7BA1\u7406</strong> \u6A21\u5757\u53EF\u4EE5\u5206\u4E3A\u4EE5\u4E0B\u529F\u80FD\uFF1A</p><ol><li>\u7528\u6237\u5217\u8868\u5206\u9875\u5C55\u793A</li><li><code>excel</code> \u5BFC\u5165\u7528\u6237</li><li>\u7528\u6237\u5217\u8868\u5BFC\u51FA\u4E3A <code>excel</code></li><li>\u7528\u6237\u8BE6\u60C5\u7684\u8868\u683C\u5C55\u793A</li><li>\u7528\u6237\u8BE6\u60C5\u8868\u683C\u6253\u5370</li><li>\u7528\u6237\u5220\u9664</li><li>\u7528\u6237\u89D2\u8272\u5206\u914D\uFF08\u9700\u8981\u5728\u5B8C\u6210\u89D2\u8272\u5217\u8868\u4E4B\u540E\u5904\u7406\uFF09</li></ol><h2 id="\u7528\u6237\u5217\u8868\u5206\u9875\u5C55\u793A" tabindex="-1"><a class="header-anchor" href="#\u7528\u6237\u5217\u8868\u5206\u9875\u5C55\u793A" aria-hidden="true">#</a> \u7528\u6237\u5217\u8868\u5206\u9875\u5C55\u793A</h2><p>\u9996\u5148\u6211\u4EEC\u5148\u6765\u5904\u7406\u6700\u57FA\u7840\u7684 <strong>\u7528\u6237\u5217\u8868\u5206\u9875\u5C55\u793A</strong> \u529F\u80FD\uFF0C\u6574\u4E2A\u529F\u80FD\u5927\u4F53\u53EF\u4EE5\u5206\u4E3A\u4E24\u6B65\uFF1A</p>',7),m=n("li",null,[n("p",null,"\u83B7\u53D6\u5206\u9875\u6570\u636E")],-1),d=s("\u5229\u7528 "),g={href:"https://element-plus.org/zh-CN/component/table.html",target:"_blank",rel:"noopener noreferrer"},v=s("el-table"),h=s(" \u548C "),y={href:"https://element-plus.org/zh-CN/component/pagination.html",target:"_blank",rel:"noopener noreferrer"},f=s("el-pagination"),w=s(" \u6E32\u67D3\u6570\u636E"),x=n("li",null,[n("p",null,[s("\u521B\u5EFA "),n("code",null,"api/user-manage"),s(" \u6587\u4EF6\uFF0C\u7528\u4E8E\u5B9A\u4E49\u63A5\u53E3")])],-1),_=t(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">&#39;@/utils/request&#39;</span>

<span class="token doc-comment comment">/**
 * \u83B7\u53D6\u7528\u6237\u5217\u8868\u6570\u636E
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getUserManageList</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/user-manage/list&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> data
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="2"><li>\u5728 <code>user-manage</code> \u4E2D\u83B7\u53D6\u5BF9\u5E94\u6570\u636E, \u6E32\u67D3 UI \u673A\u6784</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-manage<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userManageList<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100%</span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">border</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.name<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>140<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mobile<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.mobile<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.avatar<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>140<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-avatar</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope.row.avatar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>large<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-avatar</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>role<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.role<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>small<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in scope.row.role<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
            item.title
          }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
        <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>openTIme<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.openTime<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>140<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          {{ scope.row.openTime }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.action<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>small<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u67E5\u770B<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>small<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u89D2\u8272<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>small<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>danger<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>delete scope.row.id<span class="token punctuation">&quot;</span></span>
            <span class="token punctuation">&gt;</span></span>\u5220\u9664<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span>
          <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-pagination</span>
      <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">margin-top</span><span class="token punctuation">:</span> 20px</span><span class="token punctuation">&quot;</span></span></span>
      <span class="token attr-name"><span class="token namespace">v-model:</span>currentPage</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name"><span class="token namespace">v-model:</span>page-size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>size<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:page-sizes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[2, 5, 10, 20]<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total, sizes, prev, pager, next, jumper<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:total</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@size-change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleSizeChange<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@current-change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleCurrentChange<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getUserManageList <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> watchSwitchLang <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/i18n&#39;</span>
<span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// \u9875\u7801</span>
<span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// \u6BCF\u9875\u6761\u6570</span>
<span class="token keyword">const</span> total <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// \u603B\u6570</span>
<span class="token keyword">const</span> userManageList <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// \u5458\u5DE5\u5217\u8868</span>
<span class="token keyword">const</span> <span class="token function-variable function">getUserManageListData</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserManageList</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">page</span><span class="token operator">:</span> page<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token literal-property property">size</span><span class="token operator">:</span> size<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  total<span class="token punctuation">.</span>value <span class="token operator">=</span> res<span class="token punctuation">.</span>total
  userManageList<span class="token punctuation">.</span>value <span class="token operator">=</span> res<span class="token punctuation">.</span>list
<span class="token punctuation">}</span>
<span class="token function">getUserManageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u76D1\u542C\u8BED\u8A00\u53D8\u5316</span>
<span class="token function">watchSwitchLang</span><span class="token punctuation">(</span>getUserManageListData<span class="token punctuation">)</span>

<span class="token comment">// size \u6539\u53D8\u89E6\u53D1</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleSizeChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">pageSize</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  size<span class="token punctuation">.</span>value <span class="token operator">=</span> pageSize
  <span class="token function">getUserManageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// \u9875\u7801 \u6539\u53D8\u89E6\u53D1</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleCurrentChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">currentPage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  page<span class="token punctuation">.</span>value <span class="token operator">=</span> currentPage
  <span class="token function">getUserManageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br></div></div><h2 id="\u5168\u5C40\u5C5E\u6027\u5904\u7406-\u65F6\u95F4\u5C55\u793A\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u5168\u5C40\u5C5E\u6027\u5904\u7406-\u65F6\u95F4\u5C55\u793A\u95EE\u9898" aria-hidden="true">#</a> \u5168\u5C40\u5C5E\u6027\u5904\u7406 - \u65F6\u95F4\u5C55\u793A\u95EE\u9898</h2>`,4),q=s("\u5728 "),j=n("code",null,"Vue3",-1),E=s("\u4E2D\u53D6\u6D88\u4E86 "),S={href:"https://v3.cn.vuejs.org/guide/migration/filters.html",target:"_blank",rel:"noopener noreferrer"},D=s("\u8FC7\u6EE4\u5668\u7684\u6982\u5FF5"),I=s("\uFF0C\u5176\u4E2D\uFF1A"),L=n("li",null,[n("p",null,"\u5C40\u90E8\u8FC7\u6EE4\u5668\u88AB\u5B8C\u5168\u5220\u9664")],-1),U=s("\u5168\u5C40\u8FC7\u6EE4\u5668\u867D\u7136\u88AB\u79FB\u9664\uFF0C\u4F46\u662F\u53EF\u4EE5\u4F7F\u7528 app.config.globalProperties "),N={href:"https://cn.vuejs.org/api/application.html#app-config-globalproperties",target:"_blank",rel:"noopener noreferrer"},C=s("\u5168\u5C40\u5C5E\u6027"),T=s(" \u8FDB\u884C\u66FF\u4EE3"),z=s("\u65F6\u95F4\u5904\u7406\u90E8\u5206\u6211\u4EEC\u901A\u8FC7 "),R={href:"https://day.js.org/",target:"_blank",rel:"noopener noreferrer"},A=s("Day.js"),$=s(" \u8FDB\u884C\u5904\u7406"),M=s("\u4E0B\u8F7D "),O={href:"https://day.js.org/",target:"_blank",rel:"noopener noreferrer"},F=s("Day.js"),P=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`npm i dayjs@1.10.6
`)]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("span",{class:"line-number"},"1"),n("br")])],-1),X=s("\u521B\u5EFA "),B=n("code",null,"src/filter",-1),W=s(" \u6587\u4EF6\u5939\uFF0C\u7528\u4E8E\u5B9A\u4E49 "),V={href:"https://v3.cn.vuejs.org/api/application-config.html#globalproperties",target:"_blank",rel:"noopener noreferrer"},Y=s("\u5168\u5C40\u5C5E\u6027"),H=t(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> dayjs <span class="token keyword">from</span> <span class="token string">&#39;dayjs&#39;</span>

<span class="token keyword">const</span> dateFilter <span class="token operator">=</span> <span class="token punctuation">(</span>val<span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">&#39;YYYY-MM-DD&#39;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    val <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">dayjs</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$filters <span class="token operator">=</span> <span class="token punctuation">{</span>
    dateFilter
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div>`,1),J=t(`<li><p>\u5728 <code>main.js</code> \u4E2D\u5BFC\u5165</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// filter</span>
<span class="token keyword">import</span> installFilter <span class="token keyword">from</span> <span class="token string">&#39;@/filters&#39;</span>

<span class="token function">installFilter</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p>\u5728 <code>user-manage</code> \u4E2D\u4F7F\u7528\u5168\u5C40\u5C5E\u6027\u5904\u7406\u65F6\u95F4\u89E3\u6790</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.openTime<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ row }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            {{ $filters.dateFilter(row.openTime) }}
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li>`,2),K=t(`<h2 id="excel-\u5BFC\u5165-\u5BFC\u51FA" tabindex="-1"><a class="header-anchor" href="#excel-\u5BFC\u5165-\u5BFC\u51FA" aria-hidden="true">#</a> excel \u5BFC\u5165 / \u5BFC\u51FA</h2><h3 id="_1-excel-\u5BFC\u5165\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_1-excel-\u5BFC\u5165\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790" aria-hidden="true">#</a> 1) excel \u5BFC\u5165\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790</h3><p>\u5BF9\u4E8E <strong>excel \u5BFC\u5165</strong> \u9996\u5148\u6211\u4EEC\u5148\u6765\u660E\u786E\u4E00\u4E0B\u5B83\u7684\u4E1A\u52A1\u6D41\u7A0B\uFF1A</p><ol><li>\u70B9\u51FB <strong>excel \u5BFC\u5165</strong> \u6309\u94AE\u8FDB\u5165 <strong>excel \u5BFC\u5165\u9875\u9762</strong></li><li>\u9875\u9762\u63D0\u4F9B\u4E86\u4E24\u79CD\u5BFC\u5165\u5F62\u5F0F <ol><li>\u70B9\u51FB\u6309\u94AE\u4E0A\u4F20 <code>excel</code></li><li>\u628A <code>excel</code> \u62D6\u5165\u6307\u5B9A\u533A\u57DF</li></ol></li><li>\u9009\u4E2D\u6587\u4EF6\uFF0C\u8FDB\u884C\u4E24\u6B65\u64CD\u4F5C <ol><li>\u89E3\u6790 <code>excel</code> \u6570\u636E</li><li>\u4E0A\u4F20\u89E3\u6790\u4E4B\u540E\u7684\u6570\u636E</li></ol></li><li>\u4E0A\u4F20\u6210\u529F\u4E4B\u540E\uFF0C\u8FD4\u56DE <strong>\u5458\u5DE5\u7BA1\u7406\uFF08\u7528\u6237\u5217\u8868\uFF09</strong> \u9875\u9762\uFF0C\u8FDB\u884C\u6570\u636E\u5C55\u793A</li></ol><p>\u6240\u4EE5\u6839\u636E\u8FD9\u4E2A\u4E1A\u52A1\u53EF\u4EE5\u770B\u51FA\uFF0C\u6574\u4E2A <code>excel</code> \u5BFC\u5165\u6838\u5FC3\u7684\u539F\u7406\u90E8\u5206\u5728\u4E8E <strong>\u9009\u4E2D\u6587\u4EF6\u4E4B\u540E\uFF0C\u4E0A\u4F20\u6210\u529F\u4E4B\u524D</strong> \u7684\u64CD\u4F5C\uFF0C\u5373\uFF1A</p><ol><li>\u89E3\u6790 <code>excel</code> \u6570\u636E\uFF08<strong>\u6700\u91CD\u8981</strong>\uFF09</li><li>\u4E0A\u4F20\u89E3\u6790\u4E4B\u540E\u7684\u6570\u636E</li></ol><p>\u6839\u636E\u4E0A\u9762\u6240\u8BF4\uFF0C\u6574\u4E2A\u7684\u5B9E\u73B0\u6D41\u7A0B\u4E5F\u53EF\u4EE5\u5F88\u8F7B\u677E\u5F97\u51FA\uFF1A</p><ol><li>\u521B\u5EFA <code>excel</code> \u5BFC\u5165\u9875\u9762</li><li>\u70B9\u51FB <code>excel</code> \u5BFC\u5165\u6309\u94AE\uFF0C\u8FDB\u5165\u8BE5\u9875\u9762</li><li>\u8BE5\u9875\u9762\u63D0\u4F9B\u4E24\u79CD\u6587\u4EF6\u5BFC\u5165\u5F62\u5F0F</li><li>\u9009\u4E2D\u6587\u4EF6\u4E4B\u540E\uFF0C\u89E3\u6790 <code>excel</code> \u6570\u636E\uFF08\u6838\u5FC3\uFF09</li><li>\u4E0A\u4F20\u89E3\u6790\u4E4B\u540E\u7684\u6570\u636E</li><li>\u8FD4\u56DE \u5458\u5DE5\u7BA1\u7406\uFF08\u7528\u6237\u5217\u8868\uFF09 \u9875\u9762</li></ol><h3 id="_2-\u63D0\u4F9B\u4E24\u79CD\u6587\u4EF6\u5BFC\u5165\u5F62\u5F0F" tabindex="-1"><a class="header-anchor" href="#_2-\u63D0\u4F9B\u4E24\u79CD\u6587\u4EF6\u5BFC\u5165\u5F62\u5F0F" aria-hidden="true">#</a> 2) \u63D0\u4F9B\u4E24\u79CD\u6587\u4EF6\u5BFC\u5165\u5F62\u5F0F</h3><p><code>excel</code> \u9875\u9762\u5728\u4E4B\u524D\u5DF2\u7ECF\u521B\u5EFA\u8FC7\u4E86\uFF0C\u5C31\u662F <code>views/import/index</code></p><p>\u6240\u4EE5\u6B64\u5904\uFF0C\u53EA\u9700\u8981\u5728\u6309\u94AE\u5904\u5B8C\u6210\u9875\u9762\u8DF3\u8F6C\u5373\u53EF\uFF0C\u5728 <code>user-manage</code> \u4E2D</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;onImportExcelClick&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.importExcel&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button
        <span class="token operator">&gt;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token doc-comment comment">/**
 * excel \u5BFC\u5165\u70B9\u51FB\u4E8B\u4EF6
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">onImportExcelClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/user/import&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u8FD9\u6837\u5C31\u5DF2\u7ECF\u5B8C\u6210\u4E86\u524D\u9762\u4E24\u6B65\uFF0C\u63A5\u4E0B\u6765\u5B9E\u73B0 <strong>\u63D0\u4F9B\u4E24\u79CD\u6587\u4EF6\u5BFC\u5165\u5F62\u5F0F</strong></p><ol><li>\u521B\u5EFA <code>components/UploadExcel</code> <strong>\u7EC4\u4EF6</strong>\uFF0C\u7528\u4E8E\u5904\u7406\u4E0A\u4F20 <code>excel</code> \u76F8\u5173\u7684\u95EE\u9898</li><li>\u5728 <code>user/import.js</code> \u4E2D\u5BFC\u5165\u8BE5\u7EC4\u4EF6</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>upload</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>upload</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> Upload <span class="token keyword">from</span> <span class="token string">&#39;@/components/Upload/index.vue&#39;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ol start="3"><li>\u6574\u4E2A <code>UploadExcel</code> \u7EC4\u4EF6\u7684\u5185\u5BB9\u53EF\u4EE5\u5206\u6210\u4E24\u90E8\u5206\uFF1A <ol><li>\u6837\u5F0F</li><li>\u903B\u8F91</li></ol></li><li>\u90A3\u4E48\u9996\u5148\u5148\u5904\u7406\u6837\u5F0F\u5185\u5BB9</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>upload-excel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn-upload<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleUpload<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{ $t(&#39;msg.uploadExcel.upload&#39;) }}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
      <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excelUploadInput<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excel-upload-input<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.xlsx, .xls<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleChange<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drop<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@drop.stop.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleDrop<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@dragover.stop.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleDragover<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@dragenter.stop.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleDragover<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Upload</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ $t(&#39;msg.uploadExcel.drop&#39;) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> excelUploadInput <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleUpload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.upload-excel</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token selector">.excel-upload-input</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> -9999<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.btn-upload,
  .drop</span> <span class="token punctuation">{</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 1px dashed #bbb<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 350px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 160px<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 160px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.drop</span> <span class="token punctuation">{</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #bbb<span class="token punctuation">;</span>
    <span class="token selector">::v-deep .el-icon</span> <span class="token punctuation">{</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><p><img src="`+r+'" alt="\u56FE\u7247"></p><h3 id="_3-\u6587\u4EF6\u9009\u62E9\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_3-\u6587\u4EF6\u9009\u62E9\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406" aria-hidden="true">#</a> 3) \u6587\u4EF6\u9009\u62E9\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406</h3><p>\u63A5\u4E0B\u6765\u5904\u7406\u6574\u4E2A\u4E1A\u52A1\u4E2D\u6700\u6838\u5FC3\u7684\u4E00\u5757\u5185\u5BB9 <strong>\u9009\u4E2D\u6587\u4EF6\u4E4B\u540E\uFF0C\u89E3\u6790 <code>excel</code> \u6570\u636E</strong></p><p>\u89E3\u6790\u7684\u65B9\u5F0F\u6839\u636E <em>\u5BFC\u5165\u5F62\u5F0F\u7684\u4E0D\u540C</em> \u4E5F\u53EF\u4EE5\u5206\u4E3A\u4E24\u79CD\uFF1A</p><ol><li>\u6587\u4EF6\u9009\u62E9\uFF08\u9009\u62E9\u9690\u85CF\u57DF\uFF09\u5BFC\u5165</li><li>\u6587\u4EF6\u62D6\u62FD\u5BFC\u5165</li></ol><p>\u90A3\u4E48\u73B0\u5728\uFF0C\u5148\u6765\u5904\u7406\u7B2C\u4E00\u79CD\u3002</p><p>\u5904\u7406\u4E4B\u524D\u9700\u8981\u5148\u6765\u505A\u4E00\u4EF6\u4E8B\u60C5\uFF1A</p>',24),G=s("\u89E3\u6790 "),Q=n("code",null,"excel",-1),Z=s(" \u6570\u636E\u9700\u8981\u4F7F\u7528 "),nn={href:"https://www.npmjs.com/package/xlsx",target:"_blank",rel:"noopener noreferrer"},sn=s("xlsx"),an=s(" \uFF0C\u6240\u4EE5\u9700\u8981\u5148\u5B89\u88C5\u5B83"),pn=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`npm i xlsx@0.17.0
`)]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("span",{class:"line-number"},"1"),n("br")])],-1),tn={href:"https://www.npmjs.com/package/xlsx",target:"_blank",rel:"noopener noreferrer"},en=s("xlsx"),on=s(" \u5B89\u88C5\u5B8C\u6210\u4E4B\u540E\uFF0C\u63A5\u4E0B\u6765\u5C31\u53EF\u4EE5\u6765\u53BB\u5B9E\u73B0\u5BF9\u5E94\u4EE3\u7801\u4E86\uFF1A"),cn=t(`<div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> defineProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">&#39;xlsx&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getHeaderRow <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span>
<span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// \u4E0A\u4F20\u524D\u56DE\u8C03</span>
  <span class="token literal-property property">beforeUpload</span><span class="token operator">:</span> Function<span class="token punctuation">,</span>
  <span class="token comment">// \u6210\u529F\u662F\u56DE\u8C03</span>
  <span class="token literal-property property">onSuccess</span><span class="token operator">:</span> Function
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> excelUploadInput <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleUpload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  excelUploadInput<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \u70B9\u51FB\u6309\u94AE, \u6253\u5F00 input \u9009\u62E9\u6587\u4EF6\u5165\u53E3</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u9009\u62E9\u4E86\u6587\u4EF6, \u51FA\u53D1\u4E86 input \u7684 change \u4E8B\u4EF6</span>
  <span class="token keyword">const</span> files <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files
  <span class="token keyword">const</span> rawFile <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// only use files[0]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>rawFile<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token function">upload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span> <span class="token comment">// \u4E0A\u4F20</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">upload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">rawFile</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  excelUploadInput<span class="token punctuation">.</span>value<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token comment">// \u5982\u679C\u6CA1\u6709\u6307\u5B9A\u4E0A\u4F20\u524D\u56DE\u8C03</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>props<span class="token punctuation">.</span>beforeUpload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">readerData</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// \u5982\u679C\u6307\u5B9A\u4E86\u4E0A\u4F20\u524D\u56DE\u8C03\uFF0C\u90A3\u4E48\u53EA\u6709\u8FD4\u56DE true \u624D\u4F1A\u6267\u884C\u540E\u7EED\u64CD\u4F5C</span>
  <span class="token keyword">const</span> before <span class="token operator">=</span> props<span class="token punctuation">.</span><span class="token function">beforeUpload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>before<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">readerData</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/**
 * \u8BFB\u53D6\u6570\u636E\uFF08\u5F02\u6B65\uFF09
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">readerData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">rawFile</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader</span>
    <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u8BE5\u4E8B\u4EF6\u5728\u8BFB\u53D6\u64CD\u4F5C\u5B8C\u6210\u65F6\u89E6\u53D1</span>
    <span class="token comment">// https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader/onload</span>
    reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 1. \u83B7\u53D6\u89E3\u6790\u5230\u7684\u6570\u636E</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
      <span class="token comment">// 2. \u5229\u7528 XLSX \u5BF9\u6570\u636E\u8FDB\u884C\u89E3\u6790</span>
      <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;array&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 3. \u83B7\u53D6\u7B2C\u4E00\u5F20\u8868\u683C(\u5DE5\u4F5C\u7C3F)\u540D\u79F0</span>
      <span class="token keyword">const</span> firstSheetName <span class="token operator">=</span> workbook<span class="token punctuation">.</span>SheetNames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      <span class="token comment">// 4. \u53EA\u8BFB\u53D6 Sheet1\uFF08\u7B2C\u4E00\u5F20\u8868\u683C\uFF09\u7684\u6570\u636E</span>
      <span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>firstSheetName<span class="token punctuation">]</span>
      <span class="token comment">// 5. \u89E3\u6790\u6570\u636E\u8868\u5934</span>
      <span class="token keyword">const</span> header <span class="token operator">=</span> <span class="token function">getHeaderRow</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">)</span>
      <span class="token comment">// 6. \u89E3\u6790\u6570\u636E\u4F53</span>
      <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_json</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">)</span>
      <span class="token comment">// 7. \u4F20\u5165\u89E3\u6790\u4E4B\u540E\u7684\u6570\u636E</span>
      <span class="token function">generateData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> header<span class="token punctuation">,</span> results <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 8. loading \u5904\u7406</span>
      loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token comment">// 9. \u5F02\u6B65\u5B8C\u6210</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u542F\u52A8\u8BFB\u53D6\u6307\u5B9A\u7684 Blob \u6216 File \u5185\u5BB9</span>
    reader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/**
 * \u6839\u636E\u5BFC\u5165\u5185\u5BB9\uFF0C\u751F\u6210\u6570\u636E
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">generateData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">excelData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  props<span class="token punctuation">.</span>onSuccess <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span><span class="token function">onSuccess</span><span class="token punctuation">(</span>excelData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><p>getHeaderRow<code>\u4E3A</code>xlsx\` \u89E3\u6790\u8868\u5934\u6570\u636E\u7684<strong>\u901A\u7528\u65B9\u6CD5</strong>\uFF0C\u76F4\u63A5\u4F7F\u7528\u5373\u53EF</p><p>Uplaod/utils.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">&#39;xlsx&#39;</span>
<span class="token doc-comment comment">/**
 * \u83B7\u53D6\u8868\u5934\uFF08\u901A\u7528\u65B9\u5F0F\uFF09
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getHeaderRow</span> <span class="token operator">=</span> <span class="token parameter">sheet</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> range <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">decode_range</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">&#39;!ref&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> <span class="token constant">C</span>
  <span class="token keyword">const</span> <span class="token constant">R</span> <span class="token operator">=</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r
  <span class="token comment">/* start in the first row */</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token constant">C</span> <span class="token operator">=</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c<span class="token punctuation">;</span> <span class="token constant">C</span> <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/* walk every column in the range */</span>
    <span class="token keyword">const</span> cell <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">encode_cell</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">,</span> <span class="token literal-property property">r</span><span class="token operator">:</span> <span class="token constant">R</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token comment">/* find the cell in the first row */</span>
    <span class="token keyword">let</span> hdr <span class="token operator">=</span> <span class="token string">&#39;UNKNOWN &#39;</span> <span class="token operator">+</span> <span class="token constant">C</span> <span class="token comment">// &lt;-- replace with your desired default</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cell <span class="token operator">&amp;&amp;</span> cell<span class="token punctuation">.</span>t<span class="token punctuation">)</span> hdr <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">format_cell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>
    headers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>hdr<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> headers
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>\u5728 <code>import</code> \u7EC4\u4EF6\u4E2D\u4F20\u5165 <code>onSuccess</code> \u4E8B\u4EF6\uFF0C\u83B7\u53D6\u89E3\u6790\u6210\u529F\u4E4B\u540E\u7684 <code>excel</code> \u6570\u636E</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>upload-excel</span> <span class="token attr-name">:onSuccess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onSuccess<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>upload-excel</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> UploadExcel <span class="token keyword">from</span> <span class="token string">&#39;@/components/UploadExcel&#39;</span>

<span class="token doc-comment comment">/**
 * \u6570\u636E\u89E3\u6790\u6210\u529F\u4E4B\u540E\u7684\u56DE\u8C03
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token parameter">excelData</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>excelData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\u3001
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="`+i+'" alt="\u56FE\u7247"></p><h3 id="_4-\u6587\u4EF6\u62D6\u5165\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_4-\u6587\u4EF6\u62D6\u5165\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406" aria-hidden="true">#</a> 4) \u6587\u4EF6\u62D6\u5165\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406</h3>',8),ln=s("\u60F3\u8981\u4E86\u89E3 "),un=n("strong",null,"\u6587\u4EF6\u62D6\u5165",-1),rn=s("\uFF0C\u5C31\u5FC5\u987B\u8981\u5148\u80FD\u591F\u4E86\u89E3 "),kn={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API",target:"_blank",rel:"noopener noreferrer"},bn=s("HTML_Drag_and_Drop\uFF08HTML \u62D6\u653E API\uFF09"),mn=s(" \u4E8B\u4EF6\uFF0C\u8FD9\u91CC\u4E3B\u8981\u4F7F\u7528\u5230\u5176\u4E2D\u4E09\u4E2A\u4E8B\u4EF6\uFF1A"),dn={href:"https://developer.mozilla.org/en-US/docs/Web/API/Document/drop_event",target:"_blank",rel:"noopener noreferrer"},gn=s("drop (en-US)"),vn=s("\uFF1A\u5F53\u5143\u7D20\u6216\u9009\u4E2D\u7684\u6587\u672C\u5728\u53EF\u91CA\u653E\u76EE\u6807\u4E0A\u88AB\u91CA\u653E\u65F6\u89E6\u53D1"),hn={href:"https://developer.mozilla.org/en-US/docs/Web/API/Document/dragover_event",target:"_blank",rel:"noopener noreferrer"},yn=s("dragover (en-US)"),fn=s("\uFF1A\u5F53\u5143\u7D20\u6216\u9009\u4E2D\u7684\u6587\u672C\u88AB\u62D6\u5230\u4E00\u4E2A\u53EF\u91CA\u653E\u76EE\u6807\u4E0A\u65F6\u89E6\u53D1"),wn={href:"https://developer.mozilla.org/en-US/docs/Web/API/Document/dragenter_event",target:"_blank",rel:"noopener noreferrer"},xn=s("dragenter (en-US)"),_n=s("\uFF1A\u5F53\u62D6\u62FD\u5143\u7D20\u6216\u9009\u4E2D\u7684\u6587\u672C\u5230\u4E00\u4E2A\u53EF\u91CA\u653E\u76EE\u6807\u65F6\u89E6\u53D1"),qn=t(`<p>\u90A3\u4E48\u660E\u786E\u597D\u4E86\u8FD9\u4E09\u4E2A\u4E8B\u4EF6\u4E4B\u540E\uFF0C\u5C31\u53EF\u4EE5\u5B9E\u73B0\u5BF9\u5E94\u7684\u62D6\u5165\u4EE3\u7801\u903B\u8F91</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getHeaderRow<span class="token punctuation">,</span> isExcel <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus&#39;</span>

<span class="token operator">...</span>
<span class="token doc-comment comment">/**
 * \u62D6\u62FD\u6587\u672C\u91CA\u653E\u65F6\u89E6\u53D1
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleDrop</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u4E0A\u4F20\u4E2D\u8DF3\u8FC7</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token keyword">const</span> files <span class="token operator">=</span> e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>files
  <span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;\u5FC5\u987B\u8981\u6709\u4E00\u4E2A\u6587\u4EF6&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> rawFile <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isExcel</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;\u6587\u4EF6\u5FC5\u987B\u662F .xlsx, .xls, .csv \u683C\u5F0F&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// \u89E6\u53D1\u4E0A\u4F20\u4E8B\u4EF6</span>
  <span class="token function">upload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * \u62D6\u62FD\u60AC\u505C\u65F6\u89E6\u53D1
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleDragover</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// https://developer.mozilla.org/zh-CN/docs/Web/API/DataTransfer/dropEffect</span>
  <span class="token comment">// \u5728\u65B0\u4F4D\u7F6E\u751F\u6210\u6E90\u9879\u7684\u526F\u672C</span>
  e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>dropEffect <span class="token operator">=</span> <span class="token string">&#39;copy&#39;</span>
<span class="token punctuation">}</span>

<span class="token operator">...</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>\u5728 <code>utils</code> \u4E2D\u751F\u6210 <code>isExcel</code> \u65B9\u6CD5</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">isExcel</span> <span class="token operator">=</span> <span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(xlsx|xls|csv)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_5-\u6587\u4EF6\u62D6\u5165\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_5-\u6587\u4EF6\u62D6\u5165\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406" aria-hidden="true">#</a> 5) \u6587\u4EF6\u62D6\u5165\u4E4B\u540E\u7684\u6570\u636E\u89E3\u6790\u5904\u7406</h3><p>\u90A3\u4E48\u5230\u73B0\u5728\u5DF2\u7ECF\u5904\u7406\u597D\u4E86 <code>excel</code> \u7684\u6570\u636E\u89E3\u6790\u64CD\u4F5C\u3002</p><p>\u63A5\u4E0B\u6765\u53EF\u4EE5\u5B9E\u73B0\u5BF9\u5E94\u7684\u6570\u636E\u4E0A\u4F20\uFF0C\u5B8C\u6210 <code>excel</code> \u5BFC\u5165\u529F\u80FD</p><ol><li><p>\u5B9A\u4E49 <code>api/user-manage</code> \u4E0A\u4F20\u63A5\u53E3</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u6279\u91CF\u5BFC\u5165
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">userBatchImport</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/user-manage/batch/import&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
    data
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li><li><p>\u5728 <code>onSuccess</code> \u4E2D\u8C03\u7528\u63A5\u53E3\u4E0A\u4F20\u6570\u636E\uFF0C\u4F46\u662F\u6B64\u5904\u5927\u5BB6\u8981\u6CE8\u610F\u4E24\u70B9\u5185\u5BB9\uFF1A</p><ol><li><code>header</code> \u5934\u4E0D\u9700\u8981\u4E0A\u4F20</li><li><code>results</code> \u4E2D <code>key</code> \u4E3A\u4E2D\u6587\uFF0C\u6211\u4EEC\u5FC5\u987B\u8981\u6309\u7167\u63A5\u53E3\u8981\u6C42\u8FDB\u884C\u4E0A\u4F20</li></ol></li><li><p>\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u5904\u7406 <code>results</code> \u4E2D\u7684\u6570\u636E\u7ED3\u6784</p></li><li><p>\u521B\u5EFA <code>import/utils</code> \u6587\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u5BFC\u5165\u6570\u636E\u5BF9\u5E94\u8868
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">USER_RELATIONS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">\u59D3\u540D</span><span class="token operator">:</span> <span class="token string">&#39;username&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">\u8054\u7CFB\u65B9\u5F0F</span><span class="token operator">:</span> <span class="token string">&#39;mobile&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">\u89D2\u8272</span><span class="token operator">:</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">\u5F00\u901A\u65F6\u95F4</span><span class="token operator">:</span> <span class="token string">&#39;openTime&#39;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li><li><p>\u521B\u5EFA\u6570\u636E\u89E3\u6790\u65B9\u6CD5\uFF0C\u751F\u6210\u65B0\u6570\u7EC4 views/import/index.vue</p></li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> userBatchImport <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>
<span class="token keyword">import</span> Upload <span class="token keyword">from</span> <span class="token string">&#39;@/components/Upload/index.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">USER_RELATIONS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus&#39;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&#39;@/router&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-i18n&#39;</span>
<span class="token operator">...</span>

<span class="token comment">// \u7B5B\u9009\u6570\u636E</span>
<span class="token keyword">const</span> <span class="token function-variable function">generateData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      obj<span class="token punctuation">[</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ol start="6"><li>\u5B8C\u6210\u6570\u636E\u4E0A\u4F20\u5373\u53EF</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> <span class="token punctuation">{</span> userBatchImport <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>
    <span class="token keyword">import</span> Upload <span class="token keyword">from</span> <span class="token string">&#39;@/components/Upload/index.vue&#39;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">USER_RELATIONS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus&#39;</span>
    <span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&#39;@/router&#39;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> useI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-i18n&#39;</span>
   <span class="token doc-comment comment">/**
    * \u6570\u636E\u89E3\u6790\u6210\u529F\u4E4B\u540E\u7684\u56DE\u8C03
    */</span>
   <span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token function">useI18n</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token keyword">const</span> <span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> header<span class="token punctuation">,</span> results <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">const</span> updateData <span class="token operator">=</span> <span class="token function">generateData</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
     <span class="token keyword">await</span> <span class="token function">userBatchImport</span><span class="token punctuation">(</span>updateData<span class="token punctuation">)</span>
     ElMessage<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       <span class="token literal-property property">message</span><span class="token operator">:</span> results<span class="token punctuation">.</span>length <span class="token operator">+</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.importSuccess&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;success&#39;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/user/manage&#39;</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

    <span class="token keyword">const</span> <span class="token function-variable function">generateData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">...</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_6-\u5904\u7406\u5269\u4F59-bug" tabindex="-1"><a class="header-anchor" href="#_6-\u5904\u7406\u5269\u4F59-bug" aria-hidden="true">#</a> 6) \u5904\u7406\u5269\u4F59 bug</h3><p>\u622A\u6B62\u5230\u76EE\u524D\u6574\u4E2A <code>excel</code> \u4E0A\u4F20\u5C31\u5DF2\u7ECF\u5904\u7406\u5B8C\u6210\u4E86\uFF0C\u53EA\u4E0D\u8FC7\u76EE\u524D\u8FD8\u5B58\u5728\u4E24\u4E2A\u5C0F bug \u9700\u8981\u5904\u7406\uFF1A</p><ol><li>\u4E0A\u4F20\u4E4B\u540E\u7684\u65F6\u95F4\u89E3\u6790\u9519\u8BEF</li><li>\u8FD4\u56DE\u7528\u6237\u5217\u8868\u4E4B\u540E\uFF0C\u6570\u636E\u4E0D\u4F1A\u81EA\u52A8\u5237\u65B0</li></ol><p><strong>\u4E0A\u4F20\u4E4B\u540E\u7684\u65F6\u95F4\u89E3\u6790\u9519\u8BEF\uFF1A</strong></p><p>\u5BFC\u81F4\u8BE5\u95EE\u9898\u51FA\u73B0\u7684\u539F\u56E0\u662F\u56E0\u4E3A <strong>excel \u5BFC\u5165\u89E3\u6790\u65F6\u95F4\u4F1A\u51FA\u73B0\u9519\u8BEF\uFF0C</strong> \u5904\u7406\u7684\u65B9\u6848\u4E5F\u5F88\u7B80\u5355\uFF0C\u662F\u4E00\u4E2A\u56FA\u5B9A\u65B9\u6848\uFF0C\u53EA\u9700\u8981\u8FDB\u884C\u56FA\u5B9A\u7684\u65F6\u95F4\u89E3\u6790\u5904\u7406\u5373\u53EF\uFF1A</p><ol><li><p>\u5728 <code>import/utils</code> \u4E2D\u65B0\u589E\u4E8B\u4EF6\u5904\u7406\u65B9\u6CD5\uFF08\u56FA\u5B9A\u65B9\u5F0F\u76F4\u63A5\u4F7F\u7528\u5373\u53EF\uFF09</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u89E3\u6790 excel \u5BFC\u5165\u7684\u65F6\u95F4\u683C\u5F0F
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">formatDate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">numb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">(</span>numb <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">3600000</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
  time<span class="token punctuation">.</span><span class="token function">setYear</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">70</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> year <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">const</span> month <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">const</span> date <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token string">&#39;&#39;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    year <span class="token operator">+</span>
    <span class="token string">&#39;-&#39;</span> <span class="token operator">+</span>
    <span class="token punctuation">(</span>month <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">+</span> month <span class="token operator">:</span> month<span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">&#39;-&#39;</span> <span class="token operator">+</span>
    <span class="token punctuation">(</span>date <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">+</span> date <span class="token operator">:</span> date<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li><li><p>\u5728 <code>generateData</code> \u4E2D\u9488\u5BF9 <code>openTime</code> \u8FDB\u884C\u5355\u72EC\u5904\u7406</p></li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u7B5B\u9009\u6570\u636E</span>
<span class="token keyword">const</span> <span class="token function-variable function">generateData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      obj<span class="token punctuation">[</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token comment">// \u5904\u7406 excel \u7684\u4E8B\u4EF6\u663E\u793A\u683C\u65AF</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;openTime&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">formatDate</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>\u8FD4\u56DE\u7528\u6237\u5217\u8868\u4E4B\u540E\uFF0C\u6570\u636E\u4E0D\u4F1A\u81EA\u52A8\u5237\u65B0\uFF1A</strong></p><p>\u51FA\u73B0\u8BE5\u95EE\u9898\u7684\u539F\u56E0\u662F\u56E0\u4E3A\uFF1A<strong><code>appmain</code> \u4E2D\u4F7F\u7528 <code>keepAlive</code> \u8FDB\u884C\u4E86\u7EC4\u4EF6\u7F13\u5B58</strong>\u3002</p>`,20),jn=s("\u89E3\u51B3\u7684\u65B9\u6848\u4E5F\u5F88\u7B80\u5355\uFF0C\u53EA\u9700\u8981\uFF1A"),En=s("\u76D1\u542C "),Sn={href:"https://v3.cn.vuejs.org/api/options-lifecycle-hooks.html#activated",target:"_blank",rel:"noopener noreferrer"},Dn=s("onActivated"),In=s(" \u4E8B\u4EF6\uFF0C\u91CD\u65B0\u83B7\u53D6\u6570\u636E\u5373\u53EF"),Ln=t(`<p>\u5728 <code>user-manage</code> \u4E2D\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onActivated <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token comment">// \u5904\u7406\u5BFC\u5165\u7528\u6237\u540E\u6570\u636E\u4E0D\u91CD\u65B0\u52A0\u8F7D\u7684\u95EE\u9898</span>
<span class="token function">onActivated</span><span class="token punctuation">(</span>getListData<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_7-excel-\u5BFC\u5165\u529F\u80FD\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#_7-excel-\u5BFC\u5165\u529F\u80FD\u603B\u7ED3" aria-hidden="true">#</a> 7) excel \u5BFC\u5165\u529F\u80FD\u603B\u7ED3</h3><p>\u5230\u8FD9\u91CC <code>excel</code> \u5BFC\u5165\u529F\u80FD\u5C31\u5DF2\u7ECF\u5B9E\u73B0\u5B8C\u6210\uFF0C\u56DE\u987E\u4E00\u4E0B\u6574\u4F53\u7684\u6D41\u7A0B\uFF1A</p><ol><li>\u521B\u5EFA <code>excel</code> \u5BFC\u5165\u9875\u9762</li><li>\u70B9\u51FB <code>excel</code> \u5BFC\u5165\u6309\u94AE\uFF0C\u8FDB\u5165\u8BE5\u9875\u9762</li><li>\u8BE5\u9875\u9762\u63D0\u4F9B\u4E24\u79CD\u6587\u4EF6\u5BFC\u5165\u5F62\u5F0F</li><li>\u9009\u4E2D\u6587\u4EF6\u4E4B\u540E\uFF0C\u89E3\u6790 <code>excel</code> \u6570\u636E\uFF08\u6838\u5FC3\uFF09</li><li>\u4E0A\u4F20\u89E3\u6790\u4E4B\u540E\u7684\u6570\u636E</li><li>\u8FD4\u56DE \u5458\u5DE5\u7BA1\u7406\uFF08\u7528\u6237\u5217\u8868\uFF09 \u9875\u9762</li></ol><p>\u6E38\u79BB\u4E8E\u8FD9\u4E9B\u6D41\u7A0B\u4E4B\u5916\u7684\uFF0C\u8FD8\u5305\u62EC\u989D\u5916\u7684\u4E24\u4E2A\u5C0F bug \u7684\u5904\u7406\uFF0C\u7279\u522B\u662F <strong><code>excel</code> \u7684\u65F6\u95F4\u683C\u5F0F\u95EE\u9898\uFF0C</strong> \u8981\u683C\u5916\u6CE8\u610F\uFF0C\u56E0\u4E3A\u8FD9\u662F\u4E00\u4E2A\u5FC5\u7136\u4F1A\u51FA\u73B0\u7684\u9519\u8BEF\uFF0C\u5F53\u7136\u5904\u7406\u65B9\u6848\u4E5F\u662F\u56FA\u5B9A\u7684</p><h2 id="\u8F85\u52A9\u4E1A\u52A1\u4E4B\u7528\u6237\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#\u8F85\u52A9\u4E1A\u52A1\u4E4B\u7528\u6237\u5220\u9664" aria-hidden="true">#</a> \u8F85\u52A9\u4E1A\u52A1\u4E4B\u7528\u6237\u5220\u9664</h2><p>\u5B8C\u6210\u4E86 <code>excel</code> \u7684\u7528\u6237\u5BFC\u5165\u4E4B\u540E\uFF0C\u90A3\u4E48\u6211\u4EEC\u80AF\u5B9A\u4F1A\u4EA7\u751F\u5F88\u591A\u7684\u65E0\u7528\u6570\u636E\uFF0C\u6240\u4EE5\u8BF4\u63A5\u4E0B\u6765\u6211\u4EEC\u6765\u5B8C\u6210\u4E00\u4E2A\u8F85\u52A9\u529F\u80FD\uFF1A<strong>\u5220\u9664\u7528\u6237\uFF08\u5E0C\u671B\u5927\u5BB6\u90FD\u53EF\u4EE5\u5728\u5B8C\u6210 <code>excel</code> \u5BFC\u5165\u529F\u80FD\u4E4B\u540E\uFF0C\u5220\u9664\u6389\u65E0\u7528\u6570\u636E\uFF0C\u4EE5\u65B9\u4FBF\u5176\u4ED6\u7684\u540C\u5B66\u8FDB\u884C\u529F\u80FD\u6D4B\u8BD5\uFF09</strong></p><p>\u5220\u9664\u7528\u6237\u7684\u529F\u80FD\u6BD4\u8F83\u7B80\u5355\uFF0C\u6211\u4EEC\u53EA\u9700\u8981 <strong>\u8C03\u7528\u5BF9\u5E94\u7684\u63A5\u53E3\u5373\u53EF</strong></p><ol><li><p>\u5728 <code>api/user-manage</code> \u4E2D\u6307\u5B9A\u5220\u9664\u63A5\u53E3</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u5220\u9664\u6307\u5B9A\u6570\u636E
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">deleteUser</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/user-manage/detele/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li><p>\u5728 <code>views/user-manage</code> \u4E2D\u8C03\u7528\u5220\u9664\u63A5\u53E3\u63A5\u53E3</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>danger<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onRemoveClick(row)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              $t(&#39;msg.excel.remove&#39;)
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessageBox<span class="token punctuation">,</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus&#39;</span>
 <span class="token keyword">import</span> <span class="token punctuation">{</span> useI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-i18n&#39;</span>
 <span class="token operator">...</span>

<span class="token doc-comment comment">/**
 * \u5220\u9664\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6
 */</span>
<span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token function">useI18n</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">onRemoveClick</span> <span class="token operator">=</span> <span class="token parameter">row</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ElMessageBox<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span>
    i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.dialogTitle1&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span>
      row<span class="token punctuation">.</span>username <span class="token operator">+</span>
      i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.dialogTitle2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;warning&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.removeSuccess&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// \u91CD\u65B0\u6E32\u67D3\u6570\u636E</span>
    <span class="token function">getListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li></ol><h2 id="excel-\u5BFC\u51FA" tabindex="-1"><a class="header-anchor" href="#excel-\u5BFC\u51FA" aria-hidden="true">#</a> excel \u5BFC\u51FA</h2><h3 id="_1-excel-\u5BFC\u51FA\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_1-excel-\u5BFC\u51FA\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790" aria-hidden="true">#</a> 1) excel \u5BFC\u51FA\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790</h3><p>\u5BF9\u4E8E <code>excel</code> \u5BFC\u51FA\u800C\u8A00\u8FD8\u662F\u5148\u6765\u5206\u6790\u4E00\u4E0B\u5B83\u7684\u4E1A\u52A1\u903B\u8F91\uFF1A</p><ol><li>\u70B9\u51FB <code>excel</code> \u5BFC\u51FA\u6309\u94AE</li><li>\u5C55\u793A <code>dialog</code> \u5F39\u51FA\u5C42</li><li>\u786E\u5B9A\u5BFC\u51FA\u7684 <code>excel</code> \u6587\u4EF6\u540D\u79F0</li><li>\u70B9\u51FB\u5BFC\u51FA\u6309\u94AE</li><li>\u83B7\u53D6 <strong>\u6240\u6709\u7528\u6237\u5217\u8868\u6570\u636E</strong></li><li>\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E\uFF0C\u5E76\u4E0B\u8F7D</li></ol><p>\u6709\u4E86 <code>excel</code> \u5BFC\u5165\u7684\u7ECF\u9A8C\u4E4B\u540E\uFF0C\u518D\u6765\u770B\u8FD9\u6837\u7684\u4E00\u5957\u4E1A\u52A1\u903B\u8F91\uFF0C\u76F8\u4FE1\u5927\u5BB6\u5E94\u8BE5\u53EF\u4EE5\u76F4\u63A5\u6839\u636E\u8FD9\u6837\u7684\u4E00\u5957\u4E1A\u52A1\u903B\u8F91\u5F97\u51FA <code>excel</code> \u5BFC\u51FA\u7684\u6838\u5FC3\u539F\u7406\u4E86\uFF1A<strong>\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E\uFF0C\u5E76\u4E0B\u8F7D</strong></p><p>\u90A3\u4E48\u5BF9\u5E94\u7684\u5B9E\u73B0\u65B9\u6848\u4E5F\u53EF\u4EE5\u76F4\u63A5\u5F97\u51FA\u4E86\uFF1A</p><ol><li>\u521B\u5EFA <code>excel</code> \u5BFC\u51FA\u5F39\u51FA\u5C42</li><li>\u5904\u7406\u5F39\u51FA\u5C42\u76F8\u5173\u7684\u4E1A\u52A1</li><li>\u70B9\u51FB\u5BFC\u51FA\u6309\u94AE\uFF0C\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E\uFF0C\u5E76\u4E0B\u8F7D\uFF08\u6838\u5FC3\uFF09</li></ol><h3 id="_2-export2excel-\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-export2excel-\u7EC4\u4EF6" aria-hidden="true">#</a> 2) Export2Excel \u7EC4\u4EF6</h3>`,18),Un=s("\u9996\u5148\u5148\u53BB\u521B\u5EFA "),Nn=n("code",null,"excel",-1),Cn=s(" \u5F39\u51FA\u5C42\u7EC4\u4EF6 "),Tn=n("code",null,"Export2Excel ",-1),zn=s(),Rn={href:"https://element-plus.gitee.io/zh-CN/component/dialog.html",target:"_blank",rel:"noopener noreferrer"},An=s("el-dialog \u5F39\u51FA\u6846"),$n=t(`<ol><li>\u521B\u5EFA <code>views/user-manage/components/Export2Excel </code></li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span>
    <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.title<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:model-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modelValue<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>closed<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30%<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.placeholder<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excelName<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#footer</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialog-footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>closed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ $t(&#39;msg.excel.close&#39;) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onConfirm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
          $t(&#39;msg.excel.confirm&#39;)
        }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineProps<span class="token punctuation">,</span> defineEmits<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-i18n&#39;</span>
<span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">modelValue</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> emits <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;update:modelValue&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token function">useI18n</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> excelName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">onConfirm</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: \u4E1A\u52A1</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5173\u95ED</span>
<span class="token keyword">const</span> <span class="token function-variable function">closed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">emits</span><span class="token punctuation">(</span><span class="token string">&#39;update:modelValue&#39;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.dialog-footer</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>\u5728 <code>user-manage</code> \u4E2D\u8FDB\u884C\u5BFC\u5165 <code>dialog</code> \u7EC4\u4EF6</p><ol><li>\u6307\u5B9A <code>excel</code>\u6309\u94AE \u70B9\u51FB\u4E8B\u4EF6</li></ol><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>success<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>small<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onToExcelClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  {{$t(&#39;msg.excel.exportExcel&#39;)}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li><p>\u5BFC\u5165 <code>ExportToExcel</code> \u7EC4\u4EF6</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>export-to-excel</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>export2ExcelVisible<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

import ExportToExcel from &#39;./components/Export2Excel.vue&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>\u70B9\u51FB\u4E8B\u4EF6\u5904\u7406\u51FD\u6570</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * excel \u5BFC\u51FA\u70B9\u51FB\u4E8B\u4EF6
 */</span>
<span class="token keyword">const</span> export2ExcelVisible <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">onToExcelClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  export2ExcelVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ol><h3 id="_3-\u5BFC\u51FA\u524D\u7F6E\u4E1A\u52A1\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_3-\u5BFC\u51FA\u524D\u7F6E\u4E1A\u52A1\u5904\u7406" aria-hidden="true">#</a> 3) \u5BFC\u51FA\u524D\u7F6E\u4E1A\u52A1\u5904\u7406</h3><p>\u73B0\u5728\u6765\u5904\u7406\u4E00\u4E9B\u5B9E\u73B0 <code>excel</code> \u5BFC\u51FA\u65F6\u7684\u524D\u7F6E\u4EFB\u52A1\uFF0C\u5177\u4F53\u6709\uFF1A</p><ol><li>\u6307\u5B9A <code>input</code> \u8F93\u5165\u6846 \u9ED8\u8BA4\u5BFC\u51FA\u6587\u4EF6\u540D\u79F0</li><li>\u5B9A\u4E49 <strong>\u83B7\u53D6\u5168\u90E8\u7528\u6237</strong> \u5217\u8868\u63A5\u53E3\uFF0C\u5E76\u8C03\u7528</li></ol><p>\u5148\u5904\u7406\u7B2C\u4E00\u6B65\uFF1A<strong>\u6307\u5B9A <code>input</code> \u9ED8\u8BA4\u5BFC\u51FA\u6587\u4EF6\u540D\u79F0</strong></p><ol><li>\u6307\u5B9A <code>input</code> \u7684\u53CC\u5411\u7ED1\u5B9A</li></ol><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span>
      <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excelName<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.excel.placeholder<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>\u6307\u5B9A\u9ED8\u8BA4\u6587\u4EF6\u540D (\u9700\u8981\u76D1\u542C\u8BED\u8A00\u7684\u53D8\u5316)</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-i18n&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> watchSwitchLang <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/i18n&#39;</span>
<span class="token operator">...</span>

<span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token function">useI18n</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> exportDefaultName <span class="token operator">=</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> excelName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>exportDefaultName<span class="token punctuation">)</span>
<span class="token function">watchSwitchLang</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  exportDefaultName <span class="token operator">=</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span>
  excelName<span class="token punctuation">.</span>value <span class="token operator">=</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>\u5B9A\u4E49\u83B7\u53D6\u5168\u90E8\u7528\u6237\u5217\u8868\u63A5\u53E3\uFF0C\u5E76\u8C03\u7528\uFF1A</strong></p><ol><li><p>\u5728 <code>user-manage</code> \u4E2D\u5B9A\u4E49\u83B7\u53D6\u5168\u90E8\u6570\u636E\u63A5\u53E3</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u83B7\u53D6\u6240\u6709\u7528\u6237\u5217\u8868\u6570\u636E
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getUserManageAllList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/user-manage/all-list&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li><p>\u8C03\u7528\u63A5\u53E3\u6570\u636E\uFF0C\u5E76\u6307\u5B9A <code>loading</code></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onConfirm<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
	$t(&#39;msg.excel.confirm&#39;)
}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getUserManageAllList <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>

<span class="token operator">...</span> 
<span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">onConfirm</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  <span class="token comment">// \u786E\u5B9A\u6309\u94AE</span>
  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserManageAllList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>

  <span class="token comment">// TODO: \u4E1A\u52A1</span>

  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token function">closed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5173\u95ED</span>
<span class="token keyword">const</span> <span class="token function-variable function">closed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">emits</span><span class="token punctuation">(</span><span class="token string">&#39;update:modelValue&#39;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_4-\u5B9E\u73B0-excel-\u5BFC\u51FA\u903B\u8F91" tabindex="-1"><a class="header-anchor" href="#_4-\u5B9E\u73B0-excel-\u5BFC\u51FA\u903B\u8F91" aria-hidden="true">#</a> 4) \u5B9E\u73B0 excel \u5BFC\u51FA\u903B\u8F91</h3><p>\u90A3\u4E48\u4E07\u4E8B\u4FF1\u5907\uFF0C\u5230\u6B64\u65F6\u5C31\u53EF\u4EE5\u6765\u5B9E\u73B0\u6574\u4E2A\u4E1A\u52A1\u903B\u8F91\u7684\u6700\u540E\u6B65\u9AA4\uFF1A</p><ol><li>\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E</li><li>\u4E0B\u8F7D\u5BF9\u5E94\u7684 <code>excel</code> \u6570\u636E</li></ol><p>\u5BF9\u4E8E\u8FD9\u4E24\u6B65\u7684\u903B\u8F91\u800C\u8A00\uFF0C\u6700\u590D\u6742\u7684\u83AB\u8FC7\u4E8E <strong>\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E</strong> \u8FD9\u4E00\u6B65\u7684\u529F\u80FD\uFF0C\u4E0D\u8FC7\u4E07\u5E78\u7684\u662F\u5BF9\u4E8E\u8BE5\u64CD\u4F5C\u7684\u903B\u8F91\u662F <strong>\u901A\u7528\u5904\u7406\u903B\u8F91</strong>\uFF0C\u641C\u7D22 <strong>Export2Excel</strong> \u53EF\u4EE5\u5F97\u5230\u5DE8\u591A\u7684\u89E3\u51B3\u65B9\u6848\uFF0C\u6240\u4EE5\u6B64\u5904 <strong>\u6CA1\u6709\u5FC5\u8981</strong> \u624B\u5199\u5BF9\u5E94\u7684\u8F6C\u6362\u903B\u8F91</p><p>\u76F4\u63A5\u628A\u8BE5\u4EE3\u7801\u590D\u5236\u5230 <code>src/utils</code> \u6587\u4EF6\u5939\u4E0B Export2Excel.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* eslint-disable */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> saveAs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;file-saver&#39;</span>
<span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">&#39;xlsx&#39;</span>

<span class="token keyword">function</span> <span class="token function">datenum</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> date1904</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>date1904<span class="token punctuation">)</span> v <span class="token operator">+=</span> <span class="token number">1462</span>
  <span class="token keyword">var</span> epoch <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>epoch <span class="token operator">-</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token constant">UTC</span><span class="token punctuation">(</span><span class="token number">1899</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">sheet_from_array_of_arrays</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span> range <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">s</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">10000000</span><span class="token punctuation">,</span>
      <span class="token literal-property property">r</span><span class="token operator">:</span> <span class="token number">10000000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">e</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">r</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token constant">R</span> <span class="token operator">!=</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">R</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token constant">C</span> <span class="token operator">!=</span> data<span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token constant">R</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token constant">R</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">&gt;</span> <span class="token constant">C</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token constant">C</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token constant">R</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token constant">R</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c <span class="token operator">&lt;</span> <span class="token constant">C</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token constant">C</span>
      <span class="token keyword">var</span> cell <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">v</span><span class="token operator">:</span> data<span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token constant">C</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>v <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">continue</span>
      <span class="token keyword">var</span> cell_ref <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">encode_cell</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">,</span>
        <span class="token literal-property property">r</span><span class="token operator">:</span> <span class="token constant">R</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> cell<span class="token punctuation">.</span>v <span class="token operator">===</span> <span class="token string">&#39;number&#39;</span><span class="token punctuation">)</span> cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">&#39;n&#39;</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> cell<span class="token punctuation">.</span>v <span class="token operator">===</span> <span class="token string">&#39;boolean&#39;</span><span class="token punctuation">)</span> cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">&#39;b&#39;</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>v <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">&#39;n&#39;</span>
        cell<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token constant">SSF</span><span class="token punctuation">.</span>_table<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span>
        cell<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token function">datenum</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>v<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">&#39;s&#39;</span>

      ws<span class="token punctuation">[</span>cell_ref<span class="token punctuation">]</span> <span class="token operator">=</span> cell
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">)</span> ws<span class="token punctuation">[</span><span class="token string">&#39;!ref&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">encode_range</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span>
  <span class="token keyword">return</span> ws
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Workbook</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>SheetNames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>Sheets <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">s2ab</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> view<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
  <span class="token keyword">return</span> buf
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> export_json_to_excel <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  multiHeader <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  header<span class="token punctuation">,</span>
  data<span class="token punctuation">,</span>
  filename<span class="token punctuation">,</span>
  merges <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  autoWidth <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  bookType <span class="token operator">=</span> <span class="token string">&#39;xlsx&#39;</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. \u8BBE\u7F6E\u6587\u4EF6\u540D\u79F0</span>
  filename <span class="token operator">=</span> filename <span class="token operator">||</span> <span class="token string">&#39;excel-list&#39;</span>
  <span class="token comment">// 2. \u628A\u6570\u636E\u89E3\u6790\u4E3A\u6570\u7EC4\uFF0C\u5E76\u628A\u8868\u5934\u6DFB\u52A0\u5230\u6570\u7EC4\u7684\u5934\u90E8</span>
  data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>data<span class="token punctuation">]</span>
  data<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span>
  <span class="token comment">// 3. \u89E3\u6790\u591A\u8868\u5934\uFF0C\u628A\u591A\u8868\u5934\u7684\u6570\u636E\u6DFB\u52A0\u5230\u6570\u7EC4\u5934\u90E8\uFF08\u4E8C\u7EF4\u6570\u7EC4\uFF09</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> multiHeader<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>multiHeader<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 4. \u8BBE\u7F6E Excel \u8868\u5DE5\u4F5C\u7C3F\uFF08\u7B2C\u4E00\u5F20\u8868\u683C\uFF09\u540D\u79F0</span>
  <span class="token keyword">var</span> ws_name <span class="token operator">=</span> <span class="token string">&#39;SheetJS&#39;</span>
  <span class="token comment">// 5. \u751F\u6210\u5DE5\u4F5C\u7C3F\u5BF9\u8C61</span>
  <span class="token keyword">var</span> wb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 6. \u5C06 data \u6570\u7EC4\uFF08json\u683C\u5F0F\uFF09\u8F6C\u5316\u4E3A Excel \u6570\u636E\u683C\u5F0F</span>
  <span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token function">sheet_from_array_of_arrays</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token comment">// 7. \u5408\u5E76\u5355\u5143\u683C\u76F8\u5173\uFF08[&#39;A1:A2&#39;, &#39;B1:D1&#39;, &#39;E1:E2&#39;]\uFF09</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>merges<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ws<span class="token punctuation">[</span><span class="token string">&#39;!merges&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> ws<span class="token punctuation">[</span><span class="token string">&#39;!merges&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    merges<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ws<span class="token punctuation">[</span><span class="token string">&#39;!merges&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">decode_range</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 8. \u5355\u5143\u683C\u5BBD\u5EA6\u76F8\u5173</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>autoWidth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*\u8BBE\u7F6E worksheet \u6BCF\u5217\u7684\u6700\u5927\u5BBD\u5EA6*/</span>
    <span class="token keyword">const</span> colWidth <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      row<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">/*\u5148\u5224\u65AD\u662F\u5426\u4E3Anull/undefined*/</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">wch</span><span class="token operator">:</span> <span class="token number">10</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">/*\u518D\u5224\u65AD\u662F\u5426\u4E3A\u4E2D\u6587*/</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">wch</span><span class="token operator">:</span> val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">2</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">wch</span><span class="token operator">:</span> val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token comment">/*\u4EE5\u7B2C\u4E00\u884C\u4E3A\u521D\u59CB\u503C*/</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> colWidth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> colWidth<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> colWidth<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;wch&#39;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> colWidth<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;wch&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;wch&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> colWidth<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;wch&#39;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    ws<span class="token punctuation">[</span><span class="token string">&#39;!cols&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> result
  <span class="token punctuation">}</span>

  <span class="token comment">// 9. \u6DFB\u52A0\u5DE5\u4F5C\u8868\uFF08\u89E3\u6790\u540E\u7684 excel \u6570\u636E\uFF09\u5230\u5DE5\u4F5C\u7C3F</span>
  wb<span class="token punctuation">.</span>SheetNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ws_name<span class="token punctuation">)</span>
  wb<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>ws_name<span class="token punctuation">]</span> <span class="token operator">=</span> ws
  <span class="token comment">// 10. \u5199\u5165\u6570\u636E</span>
  <span class="token keyword">var</span> wbout <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">bookType</span><span class="token operator">:</span> bookType<span class="token punctuation">,</span>
    <span class="token literal-property property">bookSST</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;binary&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 11. \u4E0B\u8F7D\u6570\u636E</span>
  <span class="token function">saveAs</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">s2ab</span><span class="token punctuation">(</span>wbout<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;application/octet-stream&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>filename<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>bookType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br></div></div><p>\u90A3\u4E48\u6709\u4E86 <code>Export2Excel.js</code> \u7684\u4EE3\u7801\u4E4B\u540E \uFF0C\u63A5\u4E0B\u6765\u8FD8\u9700\u8981\u5BFC\u5165\u4E24\u4E2A\u4F9D\u8D56\u5E93\uFF1A</p>`,24),Mn={href:"https://www.npmjs.com/package/xlsx",target:"_blank",rel:"noopener noreferrer"},On=s("xlsx"),Fn=s(" \uFF08\u5DF2\u4E0B\u8F7D\uFF09\uFF1A"),Pn=n("code",null,"excel",-1),Xn=s(" \u89E3\u6790\u5668\u548C\u7F16\u8BD1\u5668"),Bn={href:"https://www.npmjs.com/package/file-saver",target:"_blank",rel:"noopener noreferrer"},Wn=s("file-saver"),Vn=s("\uFF1A\u6587\u4EF6\u4E0B\u8F7D\u5DE5\u5177\uFF0C\u901A\u8FC7 "),Yn=n("code",null,"npm i file-saver@2.0.5",-1),Hn=s(" \u4E0B\u8F7D"),Jn=t(`<p>\u90A3\u4E48\u4E00\u5207\u51C6\u5907\u5C31\u7EEA\uFF0C\u5B9E\u73B0 <code>excel</code> \u5BFC\u51FA\u529F\u80FD\uFF1A</p><ol><li>\u52A8\u6001\u5BFC\u5165 <code>Export2Excel.js</code></li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5BFC\u5165\u5DE5\u5177\u5305</span>
<span class="token keyword">const</span> excel <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;@/utils/Export2Excel&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li><p>\u56E0\u4E3A\u4ECE\u670D\u52A1\u7AEF\u83B7\u53D6\u5230\u7684\u4E3A <code>json \u6570\u7EC4\u5BF9\u8C61</code> \u7ED3\u6784\uFF0C\u4F46\u662F\u5BFC\u51FA\u65F6\u7684\u6570\u636E\u9700\u8981\u4E3A <strong>\u4E8C\u7EF4\u6570\u7EC4</strong>\uFF0C\u6240\u4EE5\u9700\u8981\u6709\u4E00\u4E2A\u65B9\u6CD5\u6765\u628A <strong><code>json</code> \u7ED3\u6784\u8F6C\u5316\u4E3A \u4E8C\u7EF4\u6570\u7EC4</strong></p></li><li><p>\u521B\u5EFA\u8F6C\u5316\u65B9\u6CD5</p><p>1.\u521B\u5EFA <code>views/user-manage/components/Export2ExcelConstants.js</code> \u4E2D\u82F1\u6587\u5BF9\u7167\u8868</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u5BFC\u5165\u6570\u636E\u5BF9\u5E94\u8868
 */</span>
 <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">USER_RELATIONS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token literal-property property">\u59D3\u540D</span><span class="token operator">:</span> <span class="token string">&#39;username&#39;</span><span class="token punctuation">,</span>
   <span class="token literal-property property">\u8054\u7CFB\u65B9\u5F0F</span><span class="token operator">:</span> <span class="token string">&#39;mobile&#39;</span><span class="token punctuation">,</span>
   <span class="token literal-property property">\u89D2\u8272</span><span class="token operator">:</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">,</span>
   <span class="token literal-property property">\u5F00\u901A\u65F6\u95F4</span><span class="token operator">:</span> <span class="token string">&#39;openTime&#39;</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>\u521B\u5EFA\u6570\u636E\u89E3\u6790\u65B9\u6CD5</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8BE5\u65B9\u6CD5\u8D1F\u8D23\u5C06\u6570\u7EC4\u8F6C\u5316\u6210\u4E8C\u7EF4\u6570\u7EC4, \`json\` \u7ED3\u6784\u8F6C\u5316\u4E3A \u4E8C\u7EF4\u6570\u7EC4</span>
<span class="token comment">// [{ username: &#39;\u5F20\u4E09&#39;, mobile:1234567489...},{},{}]  =&gt;  [[\u2019\u5F20\u4E09&#39;],[],[]]</span>
 <span class="token keyword">const</span> <span class="token function-variable function">formatJson</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">headers<span class="token punctuation">,</span> rows</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 rows<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> arrItem <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">// role \u89D2\u8272\u7279\u4F7F\u5904\u7406</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arrItem<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li><li><p>\u8C03\u7528\u8BE5\u65B9\u6CD5\uFF0C\u83B7\u53D6\u5BFC\u51FA\u7684\u4E8C\u7EF4\u6570\u7EC4\u6570\u636E</p></li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">USER_RELATIONS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./Export2ExcelConstants&#39;</span>
<span class="token operator">...</span>

<span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">onConfirm</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserManageAllList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> allUser <span class="token operator">=</span> res<span class="token punctuation">.</span>list
  <span class="token function">formatJson</span><span class="token punctuation">(</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">,</span> allUser<span class="token punctuation">)</span>
  <span class="token comment">// TODO: \u4E1A\u52A1</span>
  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token function">closed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">...</span>

<span class="token comment">// \u8BE5\u65B9\u6CD5\u8D1F\u8D23\u5C06\u6570\u7EC4\u8F6C\u5316\u6210\u4E8C\u7EF4\u6570\u7EC4, \`json\` \u7ED3\u6784\u8F6C\u5316\u4E3A \u4E8C\u7EF4\u6570\u7EC4</span>
<span class="token comment">// [{ username: &#39;\u5F20\u4E09&#39;, mobile:1234567489...},{},{}]  =&gt;  [[\u2019\u5F20\u4E09&#39;],[],[]]</span>
<span class="token keyword">const</span> <span class="token function-variable function">formatJson</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">headers<span class="token punctuation">,</span> rows</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  rows<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> arrItem <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// role \u89D2\u8272\u7279\u4F7F\u5904\u7406</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arrItem<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><ol start="5"><li>\u8C03\u7528 <code>export_json_to_excel</code> \u65B9\u6CD5\uFF0C\u5B8C\u6210 <code>excel</code> \u5BFC\u51FA</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineProps<span class="token punctuation">,</span> defineEmits<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-i18n&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> watchSwitchLang <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/i18n&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getUserManageAllList <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">USER_RELATIONS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./Export2ExcelConstants&#39;</span>
<span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">modelValue</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> emits <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;update:modelValue&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token function">useI18n</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> exportDefaultName <span class="token operator">=</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> excelName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>exportDefaultName<span class="token punctuation">)</span>
<span class="token function">watchSwitchLang</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  exportDefaultName <span class="token operator">=</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span>
  excelName<span class="token punctuation">.</span>value <span class="token operator">=</span> i18n<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;msg.excel.defaultName&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">onConfirm</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserManageAllList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> allUser <span class="token operator">=</span> res<span class="token punctuation">.</span>list
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">formatJson</span><span class="token punctuation">(</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">,</span> allUser<span class="token punctuation">)</span>
  <span class="token keyword">const</span> excel <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;@/utils/Export2Excel&#39;</span><span class="token punctuation">)</span>
  excel<span class="token punctuation">.</span><span class="token function">export_json_to_excel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// excel \u8868\u5934</span>
    <span class="token literal-property property">header</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token constant">USER_RELATIONS</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// excel \u6570\u636E\uFF08\u4E8C\u7EF4\u6570\u7EC4\u7ED3\u6784\uFF09</span>
    data<span class="token punctuation">,</span>
    <span class="token comment">// \u6587\u4EF6\u540D\u79F0</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> excelName<span class="token punctuation">.</span>value <span class="token operator">||</span> exportDefaultName<span class="token punctuation">,</span>
    <span class="token comment">// \u662F\u5426\u81EA\u52A8\u5217\u5BBD</span>
    <span class="token literal-property property">autoWidth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// \u6587\u4EF6\u7C7B\u578B</span>
    <span class="token literal-property property">bookType</span><span class="token operator">:</span> <span class="token string">&#39;xlsx&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token function">closed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5173\u95ED</span>
<span class="token keyword">const</span> <span class="token function-variable function">closed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">emits</span><span class="token punctuation">(</span><span class="token string">&#39;update:modelValue&#39;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u8BE5\u65B9\u6CD5\u8D1F\u8D23\u5C06\u6570\u7EC4\u8F6C\u5316\u6210\u4E8C\u7EF4\u6570\u7EC4, \`json\` \u7ED3\u6784\u8F6C\u5316\u4E3A \u4E8C\u7EF4\u6570\u7EC4</span>
<span class="token comment">// [{ username: &#39;\u5F20\u4E09&#39;, mobile:1234567489...},{},{}]  =&gt;  [[\u2019\u5F20\u4E09&#39;],[],[]]</span>
<span class="token keyword">const</span> <span class="token function-variable function">formatJson</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">headers<span class="token punctuation">,</span> rows</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  rows<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> arrItem <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// role \u89D2\u8272\u7279\u4F7F\u5904\u7406</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arrItem<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h3 id="_5-excel-\u5BFC\u51FA\u65F6\u7684\u65F6\u95F4\u903B\u8F91\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_5-excel-\u5BFC\u51FA\u65F6\u7684\u65F6\u95F4\u903B\u8F91\u5904\u7406" aria-hidden="true">#</a> 5) excel \u5BFC\u51FA\u65F6\u7684\u65F6\u95F4\u903B\u8F91\u5904\u7406</h3><p>\u56E0\u4E3A\u670D\u52A1\u7AEF\u8FD4\u56DE\u7684 <code>openTime</code> \u683C\u5F0F\u95EE\u9898\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u5728 <code>excel</code> \u5BFC\u51FA\u65F6\u5BF9\u65F6\u95F4\u683C\u5F0F\u8FDB\u884C\u5355\u72EC\u5904\u7406</p><ol start="2"><li><p>\u5BFC\u5165\u65F6\u95F4\u683C\u5F0F\u5904\u7406\u5DE5\u5177</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> dateFilter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/filters&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>\u5BF9\u65F6\u95F4\u683C\u5F0F\u8FDB\u884C\u5355\u72EC\u5904\u7406</p></li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u8BE5\u65B9\u6CD5\u8D1F\u8D23\u5C06\u6570\u7EC4\u8F6C\u5316\u6210\u4E8C\u7EF4\u6570\u7EC4, \`json\` \u7ED3\u6784\u8F6C\u5316\u4E3A \u4E8C\u7EF4\u6570\u7EC4</span>
<span class="token comment">// [{ username: &#39;\u5F20\u4E09&#39;, mobile:1234567489...},{},{}]  =&gt;  [[\u2019\u5F20\u4E09&#39;],[],[]]</span>
<span class="token keyword">const</span> <span class="token function-variable function">formatJson</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">headers<span class="token punctuation">,</span> rows</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  rows<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> arrItem <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// role \u89D2\u8272\u7279\u4F7F\u5904\u7406</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;openTime&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">dateFilter</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> item<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arrItem<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_6-\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#_6-\u603B\u7ED3" aria-hidden="true">#</a> 6) \u603B\u7ED3</h3><p>\u90A3\u4E48\u5230\u8FD9\u91CC\u6211\u4EEC\u7684\u6574\u4E2A <code>excel</code> \u5BFC\u51FA\u5C31\u7B97\u662F\u5B9E\u73B0\u5B8C\u6210\u4E86\u3002</p><p>\u6574\u4E2A <code>excel</code> \u5BFC\u51FA\u9075\u5FAA\u4EE5\u4E0B\u4E1A\u52A1\u903B\u8F91\uFF1A</p><ol><li>\u521B\u5EFA <code>excel</code> \u5BFC\u51FA\u5F39\u51FA\u5C42</li><li>\u5904\u7406\u5F39\u51FA\u5C42\u76F8\u5173\u7684\u4E1A\u52A1</li><li>\u70B9\u51FB\u5BFC\u51FA\u6309\u94AE\uFF0C\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E <ol><li><code>json</code> \u6570\u636E\u8F6C\u5316\u4E3A <strong>\u4E8C\u7EF4\u6570\u7EC4</strong></li><li>\u65F6\u95F4\u5904\u7406</li><li>\u89D2\u8272\u6570\u7EC4\u5904\u7406</li></ol></li><li>\u4E0B\u8F7D <code>excel</code> \u6570\u636E</li></ol><p>\u5176\u4E2D <strong>\u5C06 <code>json</code> \u7ED3\u6784\u6570\u636E\u8F6C\u5316\u4E3A <code>excel</code> \u6570\u636E</strong> \u90E8\u5206\u56E0\u4E3A\u6709\u901A\u7528\u7684\u5B9E\u73B0\u65B9\u5F0F\uFF0C\u6240\u4EE5\u6CA1\u6709\u5FC5\u8981\u8FDB\u884C\u624B\u52A8\u7684\u4EE3\u7801\u4E66\u5199\uFF0C\u6BD5\u7ADF <strong>\u7A0B\u5E8F\u733F\u662F\u6700\u61D2\u7684\u7FA4\u4F53\u561B</strong></p><h2 id="\u5C40\u90E8\u6253\u5370" tabindex="-1"><a class="header-anchor" href="#\u5C40\u90E8\u6253\u5370" aria-hidden="true">#</a> \u5C40\u90E8\u6253\u5370</h2><h3 id="_1-\u5C40\u90E8\u6253\u5370\u8BE6\u60C5\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_1-\u5C40\u90E8\u6253\u5370\u8BE6\u60C5\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790" aria-hidden="true">#</a> 1) \u5C40\u90E8\u6253\u5370\u8BE6\u60C5\u539F\u7406\u4E0E\u5B9E\u73B0\u5206\u6790</h3><p>\u6700\u540E\u4E00\u4E2A\u529F\u80FD <strong>\u5458\u5DE5\u8BE6\u60C5\u6253\u5370</strong></p><p>\u6574\u4E2A\u5458\u5DE5\u8BE6\u60C5\u7684\u6253\u5370\u903B\u8F91\u5206\u4E3A\u4E24\u90E8\u5206\uFF1A</p><ol><li>\u4EE5\u8868\u683C\u7684\u5F62\u5F0F\u5C55\u793A\u5458\u5DE5\u8BE6\u60C5</li><li>\u6253\u5370\u8BE6\u60C5\u8868\u683C</li></ol>`,21),Kn=s("\u5176\u4E2D "),Gn=n("strong",null,"\u4EE5\u8868\u683C\u7684\u5F62\u5F0F\u5C55\u793A\u5458\u5DE5\u8BE6\u60C5",-1),Qn=s(" \u90E8\u5206\u9700\u8981\u4F7F\u7528\u5230 "),Zn={href:"https://element-plus.org/zh-CN/component/descriptions.html",target:"_blank",rel:"noopener noreferrer"},ns=s("el-descriptions"),ss=s(" \u7EC4\u4EF6\uFF0C\u5E76\u4E14\u60F3\u8981\u5229\u7528\u8BE5\u7EC4\u4EF6\u5B9E\u73B0\u8BE6\u60C5\u7684\u8868\u683C\u6548\u679C\u8FD8\u9700\u8981\u4E00\u4E9B\u5C0F\u7684\u6280\u5DE7"),as=n("p",null,[s("\u800C "),n("strong",null,"\u6253\u5370\u8BE6\u60C5\u8868\u683C"),s(" \u7684\u529F\u80FD\u5C31\u662F\u5EFA\u7ACB\u5728\u5C55\u793A\u8BE6\u60C5\u9875\u9762\u4E4B\u4E0A\u7684")],-1),ps=n("p",null,[s("\u5F53\u6211\u4EEC\u5728\u6D4F\u89C8\u5668\u53F3\u952E\u65F6\uFF0C\u5176\u5B9E\u53EF\u4EE5\u76F4\u63A5\u770B\u5230\u5BF9\u5E94\u7684 "),n("strong",null,"\u6253\u5370"),s(" \u9009\u9879\uFF0C\u4F46\u662F\u8FD9\u4E2A\u6253\u5370\u9009\u9879\u662F\u76F4\u63A5\u6253\u5370\u6574\u4E2A\u9875\u9762\uFF0C\u4E0D\u80FD\u6307\u5B9A\u6253\u5370\u9875\u9762\u4E2D\u7684\u67D0\u4E00\u90E8\u5206")],-1),ts=n("p",null,[s("\u6240\u4EE5\u8BF4 "),n("strong",null,"\u6253\u5370\u662F\u6D4F\u89C8\u5668\u672C\u8EAB\u7684\u529F\u80FD"),s("\uFF0C\u4F46\u662F\u8FD9\u4E2A\u529F\u80FD\u5B58\u5728\u4E00\u5B9A\u7684\u5C0F\u7F3A\u9677\uFF0C\u90A3\u5C31\u662F "),n("strong",null,"\u53EA\u80FD\u6253\u5370\u6574\u4E2A\u9875\u9762")],-1),es=s("\u800C\u60F3\u8981\u5B9E\u73B0 "),os=n("strong",null,"\u8BE6\u60C5\u6253\u5370",-1),cs=s("\uFF0C\u90A3\u4E48\u5C31\u9700\u8981\u5728\u8FD9\u4E2A\u529F\u80FD\u7684\u57FA\u7840\u4E4B\u4E0A\u505A\u5230\u6307\u5B9A\u6253\u5370\u5177\u4F53\u7684\u67D0\u4E00\u5757\u89C6\u56FE\uFF0C\u800C\u8FD9\u4E2A\u529F\u80FD\u5DF2\u7ECF\u6709\u4E00\u4E2A\u7B2C\u4E09\u65B9\u7684\u5305 "),ls={href:"https://github.com/Power-kxLee/vue-print-nb#vue3-version",target:"_blank",rel:"noopener noreferrer"},us=s("vue-print-nb"),rs=s(" \u5E2E\u52A9\u8FDB\u884C\u4E86\u5B9E\u73B0\uFF0C\u6240\u4EE5\u53EA\u9700\u8981\u4F7F\u7528\u8FD9\u4E2A\u5305\u5373\u53EF\u5B8C\u6210\u6253\u5370\u529F\u80FD"),is=n("p",null,"\u90A3\u4E48\u660E\u786E\u597D\u4E86\u539F\u7406\u4E4B\u540E\uFF0C\u63A5\u4E0B\u6765\u6B65\u9AA4\u5C31\u547C\u4E4B\u6B32\u51FA",-1),ks=n("li",null,"\u83B7\u53D6\u5458\u5DE5\u8BE6\u60C5\u6570\u636E",-1),bs=n("li",null,"\u5728\u5458\u5DE5\u8BE6\u60C5\u9875\u9762\uFF0C\u6E32\u67D3\u8BE6\u60C5\u6570\u636E",-1),ms=s("\u5229\u7528 "),ds={href:"https://github.com/Power-kxLee/vue-print-nb#vue3-version",target:"_blank",rel:"noopener noreferrer"},gs=s("vue-print-nb"),vs=s(" \u8FDB\u884C\u5C40\u90E8\u6253\u5370"),hs=t(`<h3 id="_2-\u83B7\u53D6\u5458\u5DE5\u8BE6\u60C5\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_2-\u83B7\u53D6\u5458\u5DE5\u8BE6\u60C5\u6570\u636E" aria-hidden="true">#</a> 2) \u83B7\u53D6\u5458\u5DE5\u8BE6\u60C5\u6570\u636E</h3><p>\u9996\u5148\u6765\u83B7\u53D6\u5BF9\u5E94\u7684\u5458\u5DE5\u6570\u636E</p><ol><li><p>\u5728 <code>api/user-manage</code> \u4E2D\u5B9A\u4E49\u83B7\u53D6\u7528\u6237\u8BE6\u60C5\u63A5\u53E3</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * \u83B7\u53D6\u7528\u6237\u8BE6\u60C5
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">userDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/user-manage/detail/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li><p>\u5728 <code>views/user-info</code> \u4E2D\u6839\u636E <code>id</code> \u83B7\u53D6\u63A5\u53E3\u8BE6\u60C5\u6570\u636E\uFF0C\u5E76\u8FDB\u884C\u56FD\u9645\u5316\u5904\u7406</p></li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> userDetail <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> watchSwitchLang <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/i18n&#39;</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getUserDetail</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">userDetail</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">getUserDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u63A5\u53E3\u56FD\u9645\u5316\u5904\u7406</span>
<span class="token function">watchSwitchLang</span><span class="token punctuation">(</span>getUserDetail<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div>`,4),ys={start:"3"},fs=s("\u56E0\u4E3A\u7528\u6237\u8BE6\u60C5\u53EF\u4EE5\u4F1A\u4EE5\u7EC4\u4EF6\u7684\u5F62\u5F0F\u8FDB\u884C\u5448\u73B0\uFF0C\u6240\u4EE5\u5BF9\u4E8E\u6B64\u5904\u9700\u8981\u5F97\u5230\u7684 "),ws=n("code",null,"id",-1),xs=s(" \uFF0C\u53EF\u4EE5\u901A\u8FC7 "),_s={href:"https://next.router.vuejs.org/zh/guide/essentials/passing-props.html#%E5%B8%83%E5%B0%94%E6%A8%A1%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"},qs=s("vue-router Props \u4F20\u53C2"),js=s(" \u7684\u5F62\u5F0F\u8FDB\u884C"),Es=n("li",null,"\u6307\u5B9A\u7684\u8DEF\u7531\u8868",-1),Ss=t(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user/info/:id&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;userInfo&#39;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;@/views/user-info/index&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;userInfo&#39;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>\u5728 <code>views/user-manage</code> \u4E2D\u4F20\u9012\u7528\u6237 \`id</li></ol><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span>
    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mini<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onShowClick(row._id)<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
	{{ $t(&#39;msg.excel.show&#39;) }}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>

/**
 * \u67E5\u770B\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6
 */
const onShowClick = id =&gt; {
  router.push(\`/user/info/\${id}\`)
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_3-\u6E32\u67D3\u8BE6\u60C5\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_3-\u6E32\u67D3\u8BE6\u60C5\u7ED3\u6784" aria-hidden="true">#</a> 3) \u6E32\u67D3\u8BE6\u60C5\u7ED3\u6784</h3><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-info-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-card</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>print-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ $t(&#39;msg.userInfo.print&#39;) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-card</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-card</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-info-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u6807\u9898 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ $t(&#39;msg.userInfo.title&#39;) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- \u5934\u90E8\u6E32\u67D3\u8868\u683C --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions</span> <span class="token attr-name">:column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">border</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.name<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              detailData.username
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.sex<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              detailData.gender
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.nation<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              detailData.nationality
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.mobile<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              detailData.mobile
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.province<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              detailData.province
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.date<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
              $filters.dateFilter(detailData.openTime)
            }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.remark<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span>
                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remark<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>small<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in detailData.remark<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
                <span class="token punctuation">&gt;</span></span>{{ item }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span>
              <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span>
              <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.address<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
              <span class="token punctuation">&gt;</span></span>{{ detailData.address }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span>
            <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- \u5934\u50CF\u6E32\u67D3 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-image</span>
            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>detailData.avatar<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">:preview-src-list</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[detailData.avatar]<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- \u5185\u5BB9\u6E32\u67D3\u8868\u683C --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions</span> <span class="token attr-name">direction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vertical<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">border</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.experience<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in detailData.experience<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
                    {{ $filters.dateFilter(item.startTime, &#39;YYYY/MM&#39;) }}
                    ----
                    {{ $filters.dateFilter(item.endTime, &#39;YYYY/MM&#39;) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span>
                  <span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ item.title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ item.desc }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.major<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              {{ detailData.major }}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-descriptions-item</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">&#39;</span>msg.userInfo.glory<span class="token punctuation">&#39;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              {{ detailData.glory }}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions-item</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-descriptions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u5C3E\u90E8\u7B7E\u540D --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foot<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ $t(&#39;msg.userInfo.foot&#39;) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-card</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineProps<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> userDetail <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api/user-manage&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> watchSwitchLang <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/i18n&#39;</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> detailData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getUserDetail</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">userDetail</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  detailData<span class="token punctuation">.</span>value <span class="token operator">=</span> res
<span class="token punctuation">}</span>
<span class="token function">getUserDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u63A5\u53E3\u56FD\u9645\u5316\u5904\u7406</span>
<span class="token function">watchSwitchLang</span><span class="token punctuation">(</span>getUserDetail<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.print-box</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.user-info-box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 1024px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token selector">.title</span> <span class="token punctuation">{</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.header</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token selector">::v-deep .el-descriptions</span> <span class="token punctuation">{</span>
      <span class="token property">flex-grow</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.avatar</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 187px<span class="token punctuation">;</span>
      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 30px 20px<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ebeef5<span class="token punctuation">;</span>
      <span class="token property">border-left</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.remark</span> <span class="token punctuation">{</span>
      <span class="token property">margin-right</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.body</span> <span class="token punctuation">{</span>
    <span class="token selector">ul</span> <span class="token punctuation">{</span>
      <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token selector">li</span> <span class="token punctuation">{</span>
        <span class="token selector">span</span> <span class="token punctuation">{</span>
          <span class="token property">margin-right</span><span class="token punctuation">:</span> 62px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.foot</span> <span class="token punctuation">{</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 42px<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br></div></div><h3 id="_4-\u5C40\u90E8\u529F\u80FD\u6253\u5370\u7684\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_4-\u5C40\u90E8\u529F\u80FD\u6253\u5370\u7684\u5B9E\u73B0" aria-hidden="true">#</a> 4) \u5C40\u90E8\u529F\u80FD\u6253\u5370\u7684\u5B9E\u73B0</h3>`,6),Ds=s("\u5C40\u90E8\u8BE6\u60C5\u6253\u5370\u529F\u80FD\u6211\u4EEC\u9700\u8981\u501F\u52A9 "),Is={href:"https://github.com/Power-kxLee/vue-print-nb#vue3-version",target:"_blank",rel:"noopener noreferrer"},Ls=s("vue-print-nb"),Us=s("\uFF0C\u6240\u4EE5\u9996\u5148\u9700\u8981\u4E0B\u8F7D\u8BE5\u63D2\u4EF6"),Ns=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i vue3-print-nb@0.1.4
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u7136\u540E\u5229\u7528\u8BE5\u5DE5\u5177\u5B8C\u6210\u4E0B\u8F7D\u529F\u80FD\uFF1A</p>`,2),Cs=t(`<li><p>\u6307\u5B9A <code>printLoading</code> \u6309\u94AE\u52A8\u753B</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;el-button type=&quot;primary&quot; :loading=&quot;printLoading&quot;&gt;{{
        $t(&#39;msg.userInfo.print&#39;)
      }}&lt;/el-button&gt;

// \u6253\u5370\u76F8\u5173
const printLoading = ref(false)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li><li><p>\u521B\u5EFA\u6253\u5370\u5BF9\u8C61</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> printObj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u6253\u5370\u533A\u57DF</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;userInfoBox&#39;</span><span class="token punctuation">,</span>
  <span class="token comment">// \u6253\u5370\u6807\u9898</span>
  <span class="token literal-property property">popTitle</span><span class="token operator">:</span> <span class="token string">&#39;imooc-vue-element-admin&#39;</span><span class="token punctuation">,</span>
  <span class="token comment">// \u6253\u5370\u524D</span>
  <span class="token function">beforeOpenCallback</span><span class="token punctuation">(</span><span class="token parameter">vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    printLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// \u6267\u884C\u6253\u5370</span>
  <span class="token function">openCallback</span><span class="token punctuation">(</span><span class="token parameter">vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    printLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li><li><p>\u6307\u5B9A\u6253\u5370\u533A\u57DF <code>id</code> \u5339\u914D</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userInfoBox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-info-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li>`,3),Ts={href:"https://github.com/Power-kxLee/vue-print-nb#vue3-version",target:"_blank",rel:"noopener noreferrer"},zs=s("vue-print-nb"),Rs=s(" \u4EE5\u6307\u4EE4\u7684\u5F62\u5F0F\u5B58\u5728\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u521B\u5EFA\u5BF9\u5E94\u6307\u4EE4"),As=t(`<li><p>\u65B0\u5EFA <code>directives</code> \u6587\u4EF6\u5939\uFF0C\u521B\u5EFA <code>index.js</code></p></li><li><p>\u5199\u5165\u5982\u4E0B\u4EE3\u7801</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> print <span class="token keyword">from</span> <span class="token string">&#39;vue3-print-nb&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>print<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li><li><p>\u5728 <code>main.js</code> \u4E2D\u5BFC\u5165\u8BE5\u6307\u4EE4</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> installDirective <span class="token keyword">from</span> <span class="token string">&#39;@/directives&#39;</span>

<span class="token function">installDirective</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>\u5C06\u6253\u5370\u6307\u4EE4\u6302\u8F7D\u5230 <code>el-button</code> \u4E2D</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-print</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>printObj<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>printLoading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{
        $t(&#39;msg.userInfo.print&#39;)
      }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li>`,4),$s=n("h3",{id:"\u603B\u7ED3",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u603B\u7ED3","aria-hidden":"true"},"#"),s(" \u603B\u7ED3")],-1),Ms=n("p",null,"\u6574\u4E2A\u5C40\u90E8\u6253\u5370\u8BE6\u60C5\u529F\u80FD\uFF0C\u6574\u4F53\u7684\u6838\u5FC3\u903B\u8F91\u5C31\u662F\u4E24\u5757\uFF1A",-1),Os=n("ol",null,[n("li",null,"\u4EE5\u8868\u683C\u7684\u5F62\u5F0F\u5C55\u793A\u5458\u5DE5\u8BE6\u60C5"),n("li",null,"\u6253\u5370\u8BE6\u60C5\u8868\u683C")],-1),Fs=s("\u5176\u4E2D\u7B2C\u4E00\u90E8\u5206\u4F7F\u7528 "),Ps={href:"https://element-plus.org/zh-CN/component/descriptions.html",target:"_blank",rel:"noopener noreferrer"},Xs=s("el-descriptions"),Bs=s(" \u7EC4\u4EF6\u914D\u5408\u4E00\u4E9B\u5C0F\u6280\u5DE7\u5373\u53EF\u5B9E\u73B0"),Ws=s("\u800C\u5C40\u90E8\u6253\u5370\u529F\u80FD\u5219\u9700\u8981\u501F\u52A9 "),Vs={href:"https://github.com/Power-kxLee/vue-print-nb#vue3-version",target:"_blank",rel:"noopener noreferrer"},Ys=s("vue-print-nb"),Hs=s(" \u8FD9\u4E2A\u7B2C\u4E09\u65B9\u5E93\u8FDB\u884C\u5B9E\u73B0"),Js=n("p",null,"\u6240\u4EE5\u6574\u4E2A\u5C40\u90E8\u6253\u5370\u529F\u80FD\u5E94\u8BE5\u5E76\u4E0D\u7B97\u590D\u6742\uFF0C\u5B9E\u73B0\u8FD9\u4E24\u90E8\u5206\u5373\u53EF\u8F7B\u677E\u505A\u5230",-1);function Ks(Gs,Qs){const a=o("ExternalLinkIcon");return c(),l(u,null,[b,n("ol",null,[m,n("li",null,[n("p",null,[d,n("a",g,[v,p(a)]),h,n("a",y,[f,p(a)]),w])]),x]),_,n("p",null,[q,j,E,n("a",S,[D,p(a)]),I]),n("ol",null,[L,n("li",null,[n("p",null,[U,n("a",N,[C,p(a)]),T])]),n("li",null,[n("p",null,[z,n("a",R,[A,p(a)]),$])]),n("li",null,[n("p",null,[M,n("a",O,[F,p(a)])]),P,n("ol",null,[n("li",null,[X,B,W,n("a",V,[Y,p(a)])])]),H]),J]),K,n("ol",null,[n("li",null,[n("p",null,[G,Q,Z,n("a",nn,[sn,p(a)]),an]),pn])]),n("p",null,[n("a",tn,[en,p(a)]),on]),cn,n("p",null,[ln,un,rn,n("a",kn,[bn,p(a)]),mn]),n("ol",null,[n("li",null,[n("a",dn,[gn,p(a)]),vn]),n("li",null,[n("a",hn,[yn,p(a)]),fn]),n("li",null,[n("a",wn,[xn,p(a)]),_n])]),qn,n("p",null,[jn,n("strong",null,[En,n("a",Sn,[Dn,p(a)]),In])]),Ln,n("p",null,[Un,Nn,Cn,Tn,zn,n("a",Rn,[An,p(a)])]),$n,n("ol",null,[n("li",null,[n("a",Mn,[On,p(a)]),Fn,Pn,Xn]),n("li",null,[n("a",Bn,[Wn,p(a)]),Vn,Yn,Hn])]),Jn,n("p",null,[Kn,Gn,Qn,n("a",Zn,[ns,p(a)]),ss]),as,ps,ts,n("p",null,[es,os,cs,n("a",ls,[us,p(a)]),rs]),is,n("ol",null,[ks,bs,n("li",null,[ms,n("a",ds,[gs,p(a)]),vs])]),hs,n("ol",ys,[n("li",null,[fs,ws,xs,n("a",_s,[qs,p(a)]),js]),Es]),Ss,n("p",null,[Ds,n("a",Is,[Ls,p(a)]),Us]),Ns,n("ol",null,[Cs,n("li",null,[n("p",null,[n("a",Ts,[zs,p(a)]),Rs])]),As]),$s,Ms,Os,n("p",null,[Fs,n("a",Ps,[Xs,p(a)]),Bs]),n("p",null,[Ws,n("a",Vs,[Ys,p(a)]),Hs]),Js],64)}var na=e(k,[["render",Ks],["__file","yonghu.html.vue"]]);export{na as default};
